# <center>SEU18-19-1学期软件学院短学期实训开发记录</center>

## 环境配置

Visual Studio 2017 + Android Studio 3.14 + Cocos2dx 3.17 + Cocos Creator 2.0 + FairyGUI + TileMap Editor

## 开发记录

| 时间 |                        任务                         |       备注       |  作者  |
| :--: | :---------------------------------------------------------: | :--------------: | :----: |
| 8/19 |                         地图1 完成                          |                  |  湛钊  |
| 8/20 |                 摇杆控制人物行走，配置地图                  |       2018/8/21完成       | 张建东 |
| 8/20 | 用Cocos Creator设计一个开始界面（参考王者等游戏），要有动画 |  Due:8/27 |张睦婕|
| 8/20 |      设计一个大厅(房间)，用于开始界面后的玩家等待界面       |Due:8/27 |卢立强|
| 8/22 | 背包系统 |  |  张建东      |
| 8/22 | 远程怪物系统 |  | 张建东|
| 8/22 | 近战怪物系统 |  N/A| 张建东|
| 8/22 | 地图分层、怪物/物品点处理 | Due:8/25 | 张建东 |
| 8/23 | 网络同步处理 | Due:9/1 | 冯秋翼 |
| 8/23 | 小地图功能[弃用]| | 卢立强|
| 8/23 |攻击系统|Due:9/3|张睦婕|
| 8/27 |攻击按钮、player与Bullet衔接|Due:9/1|张建东|
| 8/27 |九龙湖校区地图|Due:8/27|湛钊|
|9/10|游戏结束界面|Due:9/12|卢立强


## 问题汇总
>  ###  0x0000
>     使用Cocos creator to cocos2d-x插件时相关资料较少一开始未找到调用方法
>
>    * Date:2018.08.20 By:张建东 卢立强

> ### 0x0001
>       Android设备分辨率和屏幕长宽比碎片化现象严重，最近还流行刘海屏曲面屏大R角等异形屏，带来适配上的困难
> >      Solution:
> >      使用fit width 风格以尽量保证在各个主流分辨率模式下都能有良好的的体验。
> >
> >      * Date:2018.08.20 By:张建东 卢立强

> ### 0x0002
>       从最初的单机版到后来的联网版带来的重构问题
>
>   * Date:2018.08.20 By:张建东 冯秋翼

> ### 0x0003
>     打算在开场处加入视频动画但是由于`Cosos Creator`制作的`Animation`导入`Cocos2dx`
>     项目后动画无法播放，决定改用其他方案。
>
>   * Date:2018.08.20 By:张睦婕

> ###  0x0004
>
> 初始化系统配置、人物移动、摇杆控制等问题
>
> > 1. 初始化系统配置，对于底层系统，采用`CommonSetting`以及`GameScene`单例模式
> > 2. 人物移动中出现了若干问题
> >    1. 人物瞬移
> >    2. 人物动画不能配合摇杆
> >    3. 起始加速度与终止惯性设定
> > 3. 摇杆：因采用`fairyGUI`，故不能与`cocos2d::scene`保持统一
>   * Date:2018.08.22 By:张建东

> ### 0x0005
>      因为屏幕的分辨率不同导致场景两端的屏幕有裁剪,因此人物移动时不能以右手坐标系的原点为基准,而应以屏幕中心点为基准。
>      但`getvisiableSize()`函数获取的屏幕size在屏幕上的显示不同于预想。
> > 解决方法
>
>根据[精通Cocos2d-x游戏开发（进阶卷）第5章 分辨率适配](https://blog.csdn.net/u010401391/article/details/79397116)
>调整屏幕的设计分辨率和分辨率配适策略。
>
>   * Date:2018.08.23 By:张睦婕

> ### 0x0006
>       Coocos creator和cocos2d-x定位系统不完全相同导致了在creator内创建的对象在creator模拟器中显示效果和cocos2d-x中不一致。
>       当Widget组件嵌套时，定位会出现差错现象。
> >       Solution:
> >       更改UI组合方式，使用扁平化的组织方式以避免定位出错。
> >       更改定位风格，使用效果更一致的定位方式。
> >
> >       * Date:2018.08.24 By：卢立强

> ### 0x0007
>     使用C++获取本地IPV4 IP Address困难。
> >      Solution:
> >      None.
> >
> >      * Date:2018.08.29 By:张建东 冯秋翼 卢立强

> ### 0x0008
>
> * 根治摇杆问题
> * tile Coord坐标问题，全网没有解决方案.jpg
> * 碰撞检测问题
>
> > Solved by 张建东
> >
> > Date : 2018.8.29
>
>

> ### 0x0009
>   Cosos引擎自身bug导致开发进度拖延
>   在合并大厅聊天室和网络通讯程序的时候，因为Cocos本身Text控件的问题，产生了在特定规律下Text控件自身现实内容消失的情况（不予显示但是控件本身依然存在，在特性条件下又能还原显示）
>   * 由于过于信任该游戏引擎且网络上未发现相关Bug的描述，该debug过程持续将近一周
> >      Solution:
> >      使用Label控件代替
> >
> >       * Date:2018.08.31 By：卢立强

> ### 0x000A
>
> 怪物跟随精度不够，解决方法：怪物继承`player`,与`player`采用相同的移动机制。
>
> 但是100+的怪物使得游戏出现卡顿现象
>
> 解决方法：弃用速度较慢的`vector`，采用手写静态`hash`记录怪物所在散列表的位置。
>
> > Solved by 张建东
> >
> > Date : 2018.9.1
>
> ### 0x000B
>
> 网络同步的若干问题
>
> ### 0x000B
>
> 碰撞检测如何更有效率？
>
> > 对于人对人，用$O(n)$的算法直接扫描，因为$n<=4$，所以没有什么影响
> >
> > 对于人对怪，只需队列记录距离较近的怪的序号，动态检测出队，在队中的怪物进行碰撞检测
> >
> > 对于怪对人，同人对人；
> >
> > 对于怪对怪，采用贪心的算法，对于一个怪生成时附近的5~10只怪进行检测（因为怪不会在美人的情况下跑出较远的距离）
> >
> > solved by 张建东
> >
> > date : 2018.9.4

> ### 0x000B
>       Android设备分辨率和屏幕长宽比与DPI各不相同，导致在纯C++开发状态下无法获取设备显示设备信息的情况下适配大厅界面产生困难
> >      Solution:
> >      将所有组件布局迁移为由画布大小及其百分比计算得出的位置，重制UI图片本身的尺寸保证配套避免使用不确定性大的缩放
> >
> >      * Date:2018.09.11 By: 卢立强